import{_ as T,a as z,b as A}from"./BuAOBssk.js";import{g as D,h as E,i as P,j as R,k as S,l as j,r as v,m as H,o,n as l,w as k,a as _,q as e,c as r,F as b,s as I,d as x,v as u,x as L,b as C,y as W,z as G}from"./CFtATmGf.js";import{_ as J}from"./Coh6grHP.js";import{u as K}from"./NXxlRH9e.js";import"./iD5fLagj.js";import"./C-v3KzvZ.js";import"./BneCoJRQ.js";import"./B4JoFVu7.js";import"./Cpj98o6Y.js";const O={key:0,class:"flex flex-col gap-8"},Q={key:2,class:"flex justify-center p-10 text-center"},X=_("br",null,null,-1),Y={key:0,class:"absolute right-0 top-1 flex gap-2"},ie=D({__name:"[post]",async setup(Z){let c,y;const w=E(),f=P(),h=R(),{loggedIn:$,user:V}=S(),d=`/api/posts/${f.params.post}`,{data:n,pending:U}=([c,y]=j(async()=>K(d,"$W6dR4D6mwF").then(async a=>(a.data.value&&await $fetch(d,{method:"PATCH"}),a))),c=await c,y(),c),i=v(!1),t=v(!1);function g(){t.value?(t.value=!1,h.replace({query:{edit:void 0}})):(t.value=!0,h.replace({query:{edit:"true"}}))}H(async()=>{var a;$.value&&((a=n.value)==null?void 0:a.user.email)===V.value.email&&(i.value=!0,f.query.edit&&(t.value=!0))});async function B(){var a,s;await $fetch(d,{method:"PUT",body:{name:(a=n.value)==null?void 0:a.name,body:(s=n.value)==null?void 0:s.body}}),w.add({icon:"i-ph-floppy-disk-duotone",color:"green",title:"Updated!"})}return(a,s)=>{const M=A,q=T,F=z,p=W,N=J;return o(),l(N,{class:"relative"},{default:k(()=>[_("div",{class:L(["post relative m-4 rounded-lg",e(t)?"border border-cyan-400":"p-4 bg-gray-100 dark:bg-gray-950 min-h-screen"])},[e(U)?(o(),r("div",O,[(o(),r(b,null,I(16,m=>C(M,{key:m,class:"w-full",style:G({height:`${Math.floor(Math.random()*3+1)}rem`}),ui:{rounded:"rounded-lg"}},null,8,["style"])),64))])):e(n)?(o(),r(b,{key:1},[e(i)&&e(t)?(o(),l(q,{key:0,modelValue:e(n).body,"onUpdate:modelValue":s[0]||(s[0]=m=>e(n).body=m),class:"min-h-screen"},null,8,["modelValue"])):e(n).body?(o(),l(F,{key:1,value:e(n).body},null,8,["value"])):(o(),r("div",Q,[_("h1",null,[x(" no content! "),X,e(i)&&!e(t)?(o(),l(p,{key:0,color:"cyan",icon:e(t)?"i-ph-x":"i-ph-pen-duotone",onClick:g},{default:k(()=>[x(" Start writing... ")]),_:1},8,["icon"])):u("",!0)])]))],64)):u("",!0)],2),e(i)?(o(),r("div",Y,[e(t)?(o(),l(p,{key:0,color:"green",icon:"i-ph-floppy-disk-duotone",onClick:B})):u("",!0),C(p,{color:"cyan",icon:e(t)?"i-ph-x":"i-ph-pen-duotone",onClick:g},null,8,["icon"])])):u("",!0)]),_:1})}}});export{ie as default};
