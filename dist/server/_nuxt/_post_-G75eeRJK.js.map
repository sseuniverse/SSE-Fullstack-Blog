{"version":3,"file":"_post_-G75eeRJK.js","sources":["../../../../pages/[post].vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport type { Post } from \"~/types\";\r\n\r\nconst toast = useToast();\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst { loggedIn, user } = useAuth();\r\n\r\nconst url = `/api/posts/${route.params.post}`;\r\n\r\nconst { data, pending } = await useFetch<Post>(url).then(async (res) => {\r\n  if (res.data.value) await $fetch(url, { method: \"PATCH\" });\r\n  return res;\r\n});\r\n\r\nconst editable = ref(false);\r\nconst editing = ref(false);\r\n\r\nfunction toggleEdit() {\r\n  if (editing.value) {\r\n    editing.value = false;\r\n    router.replace({ query: { edit: undefined } });\r\n  } else {\r\n    editing.value = true;\r\n    router.replace({ query: { edit: \"true\" } });\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  if (loggedIn.value && data.value?.user.email === user.value.email) {\r\n    editable.value = true;\r\n    if (route.query.edit) editing.value = true;\r\n  }\r\n});\r\n\r\nasync function update() {\r\n  await $fetch(url, {\r\n    method: \"PUT\",\r\n    body: {\r\n      name: data.value?.name,\r\n      body: data.value?.body,\r\n    },\r\n  });\r\n  toast.add({\r\n    icon: \"i-ph-floppy-disk-duotone\",\r\n    color: \"green\",\r\n    title: \"Updated!\",\r\n  });\r\n}\r\n</script>\r\n\r\n<template>\r\n  <UPage class=\"relative\">\r\n    <div\r\n      class=\"post relative m-4 rounded-lg\"\r\n      :class=\"\r\n        editing\r\n          ? 'border border-cyan-400'\r\n          : 'p-4 bg-gray-100 dark:bg-gray-950 min-h-screen'\r\n      \"\r\n    >\r\n      <template v-if=\"pending\">\r\n        <div class=\"flex flex-col gap-8\">\r\n          <USkeleton\r\n            v-for=\"i in 16\"\r\n            :key=\"i\"\r\n            class=\"w-full\"\r\n            :style=\"{\r\n              height: `${Math.floor(Math.random() * (3 - 1 + 1) + 1)}rem`,\r\n            }\"\r\n            :ui=\"{ rounded: 'rounded-lg' }\"\r\n          />\r\n        </div>\r\n      </template>\r\n      <template v-else-if=\"data\">\r\n        <MDCEditor\r\n          v-if=\"editable && editing\"\r\n          v-model=\"data.body\"\r\n          class=\"min-h-screen\"\r\n        />\r\n        <MDC v-else-if=\"data.body\" :value=\"data.body\" />\r\n        <div v-else class=\"flex justify-center p-10 text-center\">\r\n          <h1>\r\n            no content!\r\n            <br />\r\n            <UButton\r\n              v-if=\"editable && !editing\"\r\n              color=\"cyan\"\r\n              :icon=\"editing ? 'i-ph-x' : 'i-ph-pen-duotone'\"\r\n              @click=\"toggleEdit\"\r\n            >\r\n              Start writing...\r\n            </UButton>\r\n          </h1>\r\n        </div>\r\n      </template>\r\n    </div>\r\n\r\n    <div v-if=\"editable\" class=\"absolute right-0 top-1 flex gap-2\">\r\n      <UButton\r\n        v-if=\"editing\"\r\n        color=\"green\"\r\n        icon=\"i-ph-floppy-disk-duotone\"\r\n        @click=\"update\"\r\n      />\r\n      <UButton\r\n        color=\"cyan\"\r\n        :icon=\"editing ? 'i-ph-x' : 'i-ph-pen-duotone'\"\r\n        @click=\"toggleEdit\"\r\n      />\r\n    </div>\r\n  </UPage>\r\n</template>\r\n\r\n<style>\r\n.post h1,\r\n.post h2,\r\n.post h3,\r\n.post h4,\r\n.post h5,\r\n.post h6 {\r\n  font-weight: bold;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.post h1 {\r\n  font-size: 2rem;\r\n}\r\n\r\n.post h2 {\r\n  font-size: 1.8rem;\r\n}\r\n\r\n.post h3 {\r\n  font-size: 1.6rem;\r\n}\r\n\r\n.post h4 {\r\n  font-size: 1.4rem;\r\n}\r\n\r\n.post h5 {\r\n  font-size: 1.2rem;\r\n}\r\n\r\n.post h6 {\r\n  font-size: 1rem;\r\n}\r\n\r\n/* Paragraphs */\r\n.post p {\r\n  margin-bottom: 1rem;\r\n  line-height: 1.5;\r\n}\r\n\r\n/* Links */\r\n.post a {\r\n  color: #007bff;\r\n  /* Adjust the color as needed */\r\n  text-decoration: none;\r\n}\r\n\r\n.post a:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\n/* Preformatted text */\r\n.post pre {\r\n  background-color: #f8f9fa;\r\n  /* Adjust the background color as needed */\r\n  padding: 1rem;\r\n  overflow: auto;\r\n  font-family: \"Courier New\", Courier, monospace;\r\n}\r\n\r\n/* Lists */\r\n.post ul,\r\n.post ol {\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n/* List items */\r\n.post li {\r\n  margin-bottom: 0.5rem;\r\n}\r\n</style>\r\n"],"names":["_withAsyncContext"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,UAAM,QAAQ;AACd,UAAM,QAAQ;AACd,UAAM,SAAS;AACY,YAAQ;AAEnC,UAAM,MAAM,cAAc,MAAM,OAAO,IAAI;AAE3C,UAAM,EAAE,MAAM,QAAQ,KAAI,CAAA,QAAA,SAAA,IAAAA,iBAAA,YAAM,SAAe,KAAG,aAAA,EAAE,KAAK,OAAO,QAAQ;AAClE,UAAA,IAAI,KAAK,MAAO,OAAM,OAAO,KAAK,EAAE,QAAQ,QAAA,CAAS;AAClD,aAAA;AAAA,IAAA,CACR,CAAA;AAEK,UAAA,WAAW,IAAI,KAAK;AACpB,UAAA,UAAU,IAAI,KAAK;AAEzB,aAAS,aAAa;AACpB,UAAI,QAAQ,OAAO;AACjB,gBAAQ,QAAQ;AAChB,eAAO,QAAQ,EAAE,OAAO,EAAE,MAAM,UAAa;AAAA,MAAA,OACxC;AACL,gBAAQ,QAAQ;AAChB,eAAO,QAAQ,EAAE,OAAO,EAAE,MAAM,UAAU;AAAA,MAC5C;AAAA,IACF;AASA,mBAAe,SAAS;;AACtB,YAAM,OAAO,KAAK;AAAA,QAChB,QAAQ;AAAA,QACR,MAAM;AAAA,UACJ,OAAM,UAAK,UAAL,mBAAY;AAAA,UAClB,OAAM,UAAK,UAAL,mBAAY;AAAA,QACpB;AAAA,MAAA,CACD;AACD,YAAM,IAAI;AAAA,QACR,MAAM;AAAA,QACN,OAAO;AAAA,QACP,OAAO;AAAA,MAAA,CACR;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}